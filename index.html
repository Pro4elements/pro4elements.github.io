<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>4ELEMENTS — Banner solo imágenes</title>
<style>
  :root{--bg:#101317;--border:#1e2630;--text:#eef5ff;--accent:#58b7ff;}
  *{box-sizing:border-box} body{margin:0;font-family:Inter,system-ui,Arial;background:#101317;color:var(--text)}
  header{position:sticky;top:0;z-index:10;background:#0b0f14;border-bottom:1px solid var(--border);padding:12px 18px}
  h1{margin:0;font-size:18px;letter-spacing:.6px}
  .tools{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-top:10px}
  .chip{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);background:#11161c;padding:8px 10px;border-radius:10px;font-size:12px}
  .chip input[type=file]{border:0;background:transparent;color:var(--text)}
  button{background:#121a21;border:1px solid var(--border);color:var(--text);padding:8px 12px;border-radius:10px;cursor:pointer}
  button.primary{border-color:#2b6ea3;background:linear-gradient(180deg,rgba(88,183,255,.20),rgba(88,183,255,.06))}
  .banner{position:relative;margin:18px auto;width:100%;max-width:1200px;height:180px;overflow:hidden;background:#0f141a;border:1px solid var(--border);border-radius:20px}
  .ticker__viewport{position:relative;width:100%;height:100%;overflow:hidden}
  .ticker__track{position:absolute;inset:0;display:flex;gap:26px;align-items:center;padding:8px 16px;animation:slideRight 26s linear infinite;will-change:transform}
  .item{flex:0 0 auto;display:flex;align-items:center;justify-content:center}
  .pill{display:flex;align-items:center;justify-content:center;min-width:220px;height:140px;border-radius:18px;border:1px solid rgba(255,255,255,.10);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));box-shadow:0 16px 36px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.04)}
  .pill img{max-width:90%;max-height:100%}
  .words__track{position:absolute;left:0;right:0;bottom:0;height:36px;display:flex;gap:40px;align-items:center;padding:0 14px;font-size:13px;white-space:nowrap;background:linear-gradient(180deg,transparent,rgba(0,0,0,.25));border-top:1px solid rgba(255,255,255,.06);animation:slideLeft 23s linear infinite}
  .word{color:#bfe1ff;text-shadow:0 0 6px rgba(0,0,0,.8)}
  @keyframes slideRight{from{transform:translateX(-50%)}to{transform:translateX(0%)}}
  @keyframes slideLeft{from{transform:translateX(0%)}to{transform:translateX(-50%)}}
  .drop{margin:0 auto 14px;max-width:1200px;border:1px dashed var(--border);border-radius:14px;padding:12px;background:#0f141a}
  .grid{margin:10px auto 24px;max-width:1200px;display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px}
  .thumb{border:1px solid var(--border);border-radius:10px;background:#0b0f14;height:140px;display:flex;align-items:center;justify-content:center;overflow:hidden}
  .thumb img{max-width:100%;max-height:100%}
</style>
</head>
<body>
<header>
  <h1>4ELEMENTS — Banner con imágenes</h1>
  <div class="tools">
    <label class="chip">Añadir imágenes (PNG/JPG)
      <input id="filePicker" type="file" accept="image/*" multiple>
    </label>
    <div class="chip" id="dropHint">o suelta aquí las imágenes</div>
    <button class="primary" id="btnSave">Guardar HTML final (imágenes embebidas)</button>
    <span class="chip" id="count">0 imágenes</span>
  </div>
</header>

<div class="banner">
  <div class="ticker__viewport">
    <div class="ticker__track" id="prodTrack"></div>
  </div>
  <div class="words__track" id="wordsTrack"></div>
</div>

<div class="drop" id="dropZone">Suelta aquí PNG/JPG para añadirlos al banner (se normalizan a 400×400)</div>
<div class="grid" id="preview"></div>

<script>
/* =======================
   Banner SOLO IMÁGENES
   ======================= */

// Lista inicial (opcional) usando archivos que pongas junto al HTML.
// Si prefieres empezar vacía, deja [] y usa el importador.
let products = [
  // {img:'hardcoreroots.png'},
  // {img:'active.png'},
  // {img:'apotheosic.png'},
  // {img:'atomforze.png'},
  // {img:'base.png'},
  // {img:'bloom.png'},
  // {img:'capillary.png'},
  // {img:'glutton.png'},
  // {img:'greenperfect.png'},
  // {img:'growth.png'}
];

const words = ['EC precisa','PPFD óptimo','CO₂ controlado','DLI calculado','VPD estable','Calidad máxima','Resina top','Aroma intacto','Cosecha pro','4ELEMENTS'];

const prodTrack = document.getElementById('prodTrack');
const wordsTrack = document.getElementById('wordsTrack');
const preview = document.getElementById('preview');
const countEl = document.getElementById('count');

function renderBanner(){
  prodTrack.innerHTML = '';
  const list = products.length ? [...products, ...products] : [];
  list.forEach(p=>{
    const it = document.createElement('div'); it.className='item';
    const pill = document.createElement('div'); pill.className='pill';
    const img = document.createElement('img'); img.src = p.img; img.alt = 'Producto';
    pill.appendChild(img); it.appendChild(pill); prodTrack.appendChild(it);
  });
  // palabras
  wordsTrack.innerHTML = '';
  [...words, ...words, ...words].forEach(w=>{
    const el = document.createElement('div'); el.className='word'; el.textContent = w; wordsTrack.appendChild(el);
  });
  // previews
  preview.innerHTML = '';
  products.forEach(p=>{
    const card = document.createElement('div'); card.className='thumb';
    const img = document.createElement('img'); img.src = p.img; card.appendChild(img);
    preview.appendChild(card);
  });
  countEl.textContent = `${products.length} imágenes`;
}
renderBanner();

/* ============== Importador/normalizador 400×400 ============== */
const picker = document.getElementById('filePicker');
picker.addEventListener('change', e=> addFiles(e.target.files));

const dropZone = document.getElementById('dropZone');
;['dragenter','dragover'].forEach(ev=>dropZone.addEventListener(ev, e=>{
  e.preventDefault(); e.stopPropagation(); dropZone.style.borderColor = '#58b7ff';
}));
;['dragleave','drop'].forEach(ev=>dropZone.addEventListener(ev, e=>{
  e.preventDefault(); e.stopPropagation(); dropZone.style.borderColor = 'var(--border)';
}));
dropZone.addEventListener('drop', e=>{
  addFiles(e.dataTransfer.files);
});

function addFiles(fileList){
  if(!fileList || !fileList.length) return;
  const files = [...fileList].filter(f=>/^image\//.test(f.type));
  if(!files.length) return;
  Promise.all(files.map(f=>normalizeImage(f, 400, 400))).then(arr=>{
    // arr son dataURL PNG 400x400
    arr.forEach(dataURL=> products.push({img:dataURL}));
    renderBanner();
  });
}

// Normaliza a PNG 400×400, fondo transparente (si el PNG ya lo trae)
function normalizeImage(file, sizeW=400, sizeH=400){
  return new Promise((resolve,reject)=>{
    const fr = new FileReader();
    fr.onload = () =>{
      const img = new Image();
      img.onload = ()=>{
        const canvas = document.createElement('canvas');
        canvas.width = sizeW; canvas.height = sizeH;
        const ctx = canvas.getContext('2d');
        // limpiar transparente
        ctx.clearRect(0,0,sizeW,sizeH);
        // ajuste "contain" centrado
        const scale = Math.min(sizeW/img.width, sizeH/img.height);
        const w = img.width*scale, h = img.height*scale;
        const x = (sizeW - w)/2, y = (sizeH - h)/2;
        ctx.imageSmoothingQuality = 'high';
        ctx.drawImage(img, x, y, w, h);
        resolve(canvas.toDataURL('image/png'));
      };
      img.onerror = reject;
      img.src = fr.result;
    };
    fr.onerror = reject;
    fr.readAsDataURL(file);
  });
}

/* ============== Guardar HTML final con imágenes embebidas ============== */
document.getElementById('btnSave').addEventListener('click', ()=>{
  // Clonamos este documento y reemplazamos la variable products por la versión con data-URLs
  const html = document.documentElement.outerHTML
    .replace(/let products = \[[\s\S]*?\];/, `let products = ${JSON.stringify(products)};`);
  const blob = new Blob([html], {type:'text/html;charset=utf-8;'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = '4elements_banner_final.html';
  a.click();
});
</body>
</html>
